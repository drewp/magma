doctype html
html
  head
    script(src="/lib/polymer/1.0.9/webcomponentsjs/webcomponents.min.js")
    meta(name="viewport", content="width=1000, initial-scale=1")
    meta(name="mobile-web-app-capable", content="yes")
    meta(name="apple-mobile-web-app-capable", content="yes")

    title magma
    link(rel="shortcut icon", sizes="90x90", href="icon-90.png")
    link(rel="stylesheet", href="style.css")

    //link(rel="import", href="magma-chat.html")
    link(rel="import", href="components/magma-plot.html")
    //link(rel="import", href="magma-photo.html")
    //link(rel="import", href="magma-overlay-diagram.html")
    link(rel="import", href="/heist/heist-recent-transactions.html")
    link(rel="import", href="/leaf/leaf-report.html")
    link(rel="import", href="/countdown/countdown-view.html")
    link(rel="import", href="/lib/polymer/1.0.9/platinum-sw/platinum-sw-register.html")
    link(rel="import", href="/lib/polymer/1.0.9/platinum-sw/platinum-sw-cache.html")
    script.
      window.NS = {
        dev: 'http://projects.bigasterisk.com/device/',
        room: 'http://projects.bigasterisk.com/room/',
        rdfs: 'http://www.w3.org/2000/01/rdf-schema#',
        sensor: 'http://bigasterisk.com/homeauto/sensor/',
        b0: 'http://bigasterisk.com/homeauto/board0/',
      };
  body
    platinum-sw-register(auto-register)
      platinum-sw-cache(default-cache-strategy="fastest")
    div.body2
      div
        div.cell
          | chat goes here
        div.cell
          | Locations
          div
            span.who person1
            | near daly city bart, ETA home at 19:21 (51 minutes)
          div 
            span.who person2 phone
            | phone is home, on wifi; keys by front door
          div 
            span.who Apollo
            | living room couch (for 12 minutes)
          div 
            span.who person3
            | phone last seen on wifi 8 minutes ago
          div
            span.who person4
            | computer last used at 07:14
            
        div.cell.crammedFrame(style="background-color: #c86866")
          div: a(href="/ruler/analysis/") ruler failing checks
          iframe(src="/ruler/analysis/")
        div.cell.crammedFrame(style="background-color: #15743c")
          div: a(href="https://bigasterisk.com/wifi/") wifi users and recent visitors
          iframe(src="https://bigasterisk.com/wifi/table")
        div.cell.flexFit(style="background-color: #e3c334")
          | HA nodes
          div(style="overflow-y: auto; height: 100%")
            table
              tr
                th: a(href="/pi/living/") living
                td: a(href="/supdebug/living/") supdebug
                td: a(href="") pandora
              tr
                th: a(href="/pi/kitchen/") kitchen
                td: a(href="/supdebug/kitchen/") supdebug
                td: a(href="") pandora
              tr
                th: a(href="/pi/bed/") bed
                td: a(href="/supdebug/bed/") supdebug
              tr
                th: a(href="/pi/changing/") changing
                td: a(href="/supdebug/changing/") supdebug
              tr  
                th: a(href="") dash
                td: a(href="/supdebug/dash/") supdebug
                td: a(href="/music/dash/#/0") music
              tr
                th: a(href="/arduino/bang/") bang
                td: a(href="/supdebug/bang/") supdebug
              tr
                th: a(href="/arduino/slash/") slash
                td: a(href="/supdebug/slash/") supdebug
                td: a(href="/music/slash/#/0") music
              tr
                th: a(href="/arduino/brace/") ariroom
                td: a(href="/supdebug/brace/") supdebug
                td: a(href="/music/brace/#/0") music
          
        div.cell.flexFit(style="background-color: #ec8281")
          heist-recent-transactions()

        div.cell.flexFit(style="background-color: #876853")
          a.otherPage(href="/grafana/") Grafana
          ul
            li: a.otherPage(href="/grafana/dashboard/db/temperatures") Temperatures
            li: a.otherPage(href="/grafana/dashboard/db/power") Power
            li: a.otherPage(href="/grafana/dashboard/db/presence") Presence
          a.otherPage(href="//checkvist.com/checklists/422518") Family checkvist
          a.otherPage(href="/gasuse/submitFillUp") Gasuse submit
          a.otherPage(href="/diary/") Diarybot
          
          a.otherPage(href="/map/") Map
          a.otherPage(href="/search/") Search
          a.otherPage(href="/search/files/") File search
          a.otherPage(href="/sfd/") SFD
          a.otherPage(href="https://whatsplayingnext.com/upcoming") Whatsplayingnext
          a.otherPage(href="https://docs.google.com/spreadsheets/d/1dT-hzFMcpmhgwNlec22LG_N74HgRc8xWzifHpCbCv7k/edit#gid=0") Whopickedthis

          a.otherPage(href="http://10.2.0.47:8080/") stream note2 intercom
          a.otherPage(href="/beacon/") beacon map
          a.otherPage(href="/logins/") logins 

        div.cell.flexFit
          magma-photo(uri="http://photo.bigasterisk.com/digicam/dl-2011-09-16/DSC_3992.JPG")
        div.cell.chat
          magma-chat.chat()
          ol
            li todo:
            li support multiple light controls from multiple hosts
            li sync light control values
            li surface some supervisor buttons, like minetest
            li decompose power to known components: heater, fridge, computers, screens
            li show screen power, turn off screens remotely
            li master light controls, like 'all lights off'
            li make wifi widget smaller, show useful info
            li make ruler summarize better
            li fix heist to show txns
            li unfold/expand sections as they become ready
            li touch section to zoom it to full screen
            li chat support
            li music player widget
            

        div.cell.flexFit(style="background-color: #c10e2c")
          countdown-view()
        div.cell(style="flex: 0 0")
          | Root page rendered at SERVE_TIME
    magma-overlay-diagram()
