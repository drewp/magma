#!/usr/bin/python
import os, sys
from twisted.internet import reactor
from twisted.python import log
from twisted.python.util import sibpath
from nevow.appserver import NevowSite
from nevow import rend, static, loaders, tags as T, inevow, json


"""
need ajaxy supervisor interface

"""

os.chdir("/my/site/magma")

class Running(rend.Page):
    docFactory = loaders.stan(T.img(src="out"))
    def child_out(self, ctx):
        return static.File("running/out.png")

class Main(rend.Page):
    docFactory = loaders.xmlfile("magma-sample2.html")
    # if this is from a phone, use the little menu. the big menu
    # should also be ext, and have links to all the inner services.
    
    def child_running(self, ctx):
        return Running()
    def child_net(self, ctx):
        return static.File("nets.html")
    def child_images(self, ctx):
        return static.File("images")
    
setattr(Main, "child_dojo-0.4.2-ajax", static.File("dojo-0.4.2-ajax"))

log.startLogging(sys.stdout)

reactor.listenTCP(8006, NevowSite(Main()))
reactor.run()
